# Get Vulnerability

## Endpoint Overview

The Get Vulnerability endpoint is used to retrieve data about a particular vulnerability, specified by the vulnerability ID.

## API Request

The Get Vulnerability endpoint is rather straightforward, for it only requires one parameter outside of your API key and region - that one parameter being the ID of the vulnerability you wish to retrieve information about.

Get Vulnerability is a simple endpoint that uses a `GET` request. This means that, unlike some other endpoints which utilize `POST` requests, we do not need to pass it a body of data. Instead, we only need to append our vulnerability ID to the URL for the endpoint and we are good to go.

The url we will be `GET`ting is `https://us.api.insight.rapid7.com/ias/v1/vulnerabilities/$vuln_ID`, where `$vuln_ID` is considered a URL parameter and contains the ID of the vulnerability you wish to retrieve data for:

```
$api_url = "https://us.api.insight.rapid7.com/ias/v1/"
$api_endpoint = 'vulnerabilities/'
$vuln_ID = '00000000-0000-0000-0000-000000000000'
$uri = "$api_url$api_endpoint$vuln_ID"
```

Additionally, we will want to set up our headers, which will consist solely of our API key:

```
$api_key = 'Your-api-key-here'
$headers = @{'X-Api-Key' = $api_key}
```

With all of our other standard parameters assigned, performing the request is simple and requires the usage of the `Invoke-RestMethod` function. 

```
$vuln_data = @{}

$output = Invoke-RestMethod -Uri $uri -Headers $headers -Method 'GET'
$vuln_data = $output | ConvertTo-Json
```

`$vuln_data` will contain the information from the `$output` variable, converted into JSON format, which contains all of the data retrieved from the endpoint.


## Output
By now, `$vuln_data` should contain some data. The following is the result to `stdout` displayed in the terminal when running `echo $vulns`:

`vuln_data` is a variable which holds a set of key-value pairs describing the vulnerability.

Shown below are the contents of `vuln_data` following a successful API call:
```
{
    "app": {
        "id": "00000000-0000-0000-0000-000000000000"
    },
    "id": "00000000-0000-0000-0000-000000000000",
    "links": [
        {
            "href": "https://us.api.insight.rapid7.com:443/ias/v1/vulnerabilities/00000000-0000-0000-0000-000000000000",
            "rel": "self"
        }
    ],
    "root_cause": {
        "method": "POST",
        "parameter": "passwd",
        "url": "http://website.com/page.php"
    },
    "severity": "HIGH",
    "status": "UNREVIEWED",
    "variances": [
        {
            "attack": {
                "id": "000_00"
            },
            "attack_exchanges": [
                {
                    "request": "GET /login.php HTTP/1.1\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: en-US\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.168 Safari/535.19\r\nHost: webscantest.com\r\n\r\n",
                    "response": "HTTP/1.1 200 OK\r\nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\r\nConnection: close\r\nDate: Tue, 01 Oct 2019 15:28:05 GMT\r\nPragma: no-cache\r\nContent-Length: 688\r\nContent-Type: text/html\r\nContent-Encoding: gzip\r\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\r\nServer: Apache/2.4.7 (Ubuntu)\r\nSet-Cookie: TEST_SESSIONID=00000000-0000-0000-0000-000000000000; path=/\r\nSet-Cookie: NB_SRVID=00000000-0000-0000-0000-000000000000; path=/\r\nVary: Accept-Encoding\r\nX-Powered-By: PHP/5.5.9-1ubuntu4.29"
                },
                {
                    "request": "POST /login.php HTTP/1.1\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: en-US\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.168 Safari/535.19\r\nHost: webscantest.com\r\nContent-Length: 43\r\nReferer: http://webscantest.com/page.php\r\nContent-Type: application/x-www-form-urlencoded\r\nCookie: TEST_SESSIONID=00000000-0000-0000-0000-000000000000; NB_SRVID=00000000-0000-0000-0000-000000000000\r\n\r\nlogin=admin&passwd=admin&submit_login=login",
                    "response": "HTTP/1.1 302 Found\r\nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\r\nConnection: close\r\nDate: Tue, 01 Oct 2019 15:28:05 GMT\r\nPragma: no-cache\r\nContent-Length: 0\r\nContent-Type: text/html\r\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\r\nLocation: /\r\nServer: Apache/2.4.7 (Ubuntu)\r\nX-Powered-By: PHP/5.5.9-1ubuntu4.29"
                }
            ],
            "attack_value": "Username=admin \nand \nPassword=admin",
            "message": "Logged in state was detected with the regex match 'logout'",
            "module": {
                "id": "00000000-0000-0000-0000-000000000000"
            },
            "original_exchange": {
                "request": "POST /login.php HTTP/1.1\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: en-US\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.168 Safari/535.19\r\nHost: webscantest.com\r\nContent-Length: 52\r\nReferer: http://webscantest.com/page.php\r\nContent-Type: application/x-www-form-urlencoded\r\nCookie: TEST_SESSIONID=jjv3fm2ajd41vul4fbe3jl4kn6; NB_SRVID=srv140717\r\n\r\nlogin=x78pwpzs&passwd=x78pwpzt%24&submit_login=login",
                "response": "HTTP/1.1 302 Found\r\nCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\r\nConnection: close\r\nDate: Tue, 01 Oct 2019 15:07:09 GMT\r\nPragma: no-cache\r\nContent-Length: 0\r\nContent-Type: text/html\r\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\r\nLocation: /login.php\r\nServer: Apache/2.4.7 (Ubuntu)\r\nSet-Cookie: login_error=Bad+user+name+or+password; expires=Tue, 01-Oct-2019 17:07:09 GMT; Max-Age=7200\r\nX-Powered-By: PHP/5.5.9-1ubuntu4.29"
            },
            "original_value": "x78pwpzt%24"
        }
    ]
}
```

Any of this data can be accessed by indexing `$vuln_data`. For instance, one may access the "severity" field by using `$vuln_data.severity`.
import requests

# Setup standard parameters
region = "us"
api_url = f"https://{region}.api.insight.rapid7.com/ias/v1/"
api_key = "your-api-key-here"
api_path = "vulnerabilities/"
vuln_id = "00000000-0000-0000-0000-000000000000"
full_url = api_url + api_path + vuln_id

headers = {"X-Api-Key": api_key}

# Output from endpoint will be stored here
vuln_data = {}

try:
    # Make API request
    response = requests.get(url=full_url, headers=headers)

    # Raise HTTP Error if it occurred
    response.raise_for_status()

    # Get data from response object
    vuln_data = response.json()

except requests.exceptions.HTTPError as he:
    print("HTTP error:", he)
except requests.exceptions.ConnectionError as ce:
    print("Connection error:", ce)
except requests.exceptions.RequestException as e:
    print("Request exception:", e)

import json
print(json.dumps(vuln_data,indent=4, sort_keys=True))
